<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>监控插件测试页面</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
        }

        button {
            padding: 10px 20px;
            margin: 10px;
            font-size: 16px;
            cursor: pointer;
        }

        .error-btn {
            background: #ff4444;
            color: white;
        }
    </style>

    <!-- 监控插件嵌入代码 -->
    <!-- 
      部署说明：
      1. 开发环境：apiUrl 使用带端口的地址，如 'http://localhost:3002'
      2. 生产环境（宝塔部署）：apiUrl 使用同域地址，如 'http://web.yuwb.cn' 或 'https://web.yuwb.cn'
         - Nginx 会将 /api/ 路径反向代理到后端服务
         - 插件会自动在 apiUrl 后添加 /api/events 路径
    -->
    <script>
      (function() {
    var script = document.createElement('script');
    // 插件文件地址（生产环境：同域访问；开发环境：可指定完整路径）
    script.src = 'http://web.yuwb.cn/plugin/monitoring.js';
    script.onload = function() {
      window.WebPageMonitoring.init({
        // 生产环境：使用同域地址（Nginx 反向代理处理 /api/ 路径）
        // 开发环境：使用 'http://localhost:3002'
        apiUrl: 'http://web.yuwb.cn',  // 部署后使用同域地址，无需端口号
        projectKey: '0346c20e5580a8d83b0372089bbfdd8d',
        autoTrack: true,
        trackPageView: true,
        trackClick: true,
        trackError: true,
        trackPerformance: true
      });
    };
    document.head.appendChild(script);
  })();
    </script>
</head>

<body>
    <h1>监控插件测试页面</h1>
    <p>这是一个测试页面，用于验证监控插件是否正常工作。</p>

    <h2>测试功能</h2>
    <button onclick="testClick()">测试点击事件</button>
    <button onclick="testError()" class="error-btn">测试错误捕获</button>
    <button onclick="testCustomEvent()">测试自定义事件</button>

    <h2>说明</h2>
    <ol>
        <li>请先在前端面板创建项目并获取项目 Key</li>
        <li>将上面的 projectKey 替换为你的项目 Key</li>
        <li><strong>开发环境</strong>：apiUrl 设置为 'http://localhost:3002'</li>
        <li><strong>生产环境（宝塔部署）</strong>：apiUrl 设置为同域地址，如 'http://web.yuwb.cn'（无需端口号）</li>
        <li>打开此页面，点击上面的按钮测试各种功能</li>
        <li>在前端面板查看收集到的数据</li>
    </ol>

    <script>
        function testClick() {
            alert('点击事件已触发，请在前端面板查看数据');
        }

        function testError() {
            // 故意触发一个错误
            throw new Error('这是一个测试错误');
        }

        function testCustomEvent() {
            if (window.WebPageMonitoring) {
                window.WebPageMonitoring.track('custom', {
                    action: 'test',
                    message: '这是一个自定义事件'
                });
                alert('自定义事件已发送');
            } else {
                alert('监控插件未加载');
            }
        }
    </script>
</body>

</html>